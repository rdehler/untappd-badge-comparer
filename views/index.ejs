<!DOCTYPE html>
<html>
  <head>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  </head>
  <body>
    <script>
      function newItem(item) {
        var ret = '';
        ret += "<div class='newItem'>";
        ret += "<div class='title'>'+item.badge_name+'</div>";
        ret += "<img src='"+item.media.badge_image_sm+"' width='90' />"
        ret += "</div>";
        return ret;
      }
      // html entities decode and parse into json object
      var preparsed, replaced, jsonString, response;
      $(document).ready(function() {
        preparsed = "<%= json %>";
        replaced = preparsed.replace(/\r\n/g, '');
        jsonString = $('<div/>').html("<%= json %>".replace(/\r\n/g, '')).text();
        response = JSON.parse(jsonString);
        for (var item in response.response.items) {
          $('#badges').append(newItem(response.response.items[item]));
        }
      });
    </script>
    <div id="badges">

    </div>
  </body>
</html>
